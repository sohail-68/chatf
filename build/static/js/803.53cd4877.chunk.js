/*! For license information please see 803.53cd4877.chunk.js.LICENSE.txt */
"use strict";(self.webpackChunkclient=self.webpackChunkclient||[]).push([[803],{803:(e,t,s)=>{s.r(t),s.d(t,{default:()=>x});var a=s(791),o=s(409),i=s(221),r=s(262),n=s(100);const l=(0,n.Z)("bookmark",[["path",{d:"m19 21-7-4-7 4V5a2 2 0 0 1 2-2h10a2 2 0 0 1 2 2v16z",key:"1fy3hk"}]]),c=(0,n.Z)("message-circle-more",[["path",{d:"M7.9 20A9 9 0 1 0 4 16.1L2 22Z",key:"vv11sd"}],["path",{d:"M8 12h.01",key:"czm47f"}],["path",{d:"M12 12h.01",key:"1mp3jc"}],["path",{d:"M16 12h.01",key:"1l6xoz"}]]);var d=s(689),m=s(903),u=s(85),p=(s(462),s(184));const h=e=>{let{post:t,handleDeleteSuccess:s}=e;const[n,h]=(0,a.useState)(""),[x,g]=(0,a.useState)(""),[y,f]=(0,a.useState)(!1),[b,k]=(0,a.useState)(t.likes.length),v=(0,a.useRef)(),j=(0,d.s0)();(0,a.useEffect)((()=>{const e=t.likes.some((e=>e.user===sessionStorage.getItem("userid")));f(e)}),[t.likes]);const w="\ud83d\ude10",N="\ud83d\ude0a",E="\ud83d\ude22";return(0,p.jsxs)(i.E.div,{variants:{hidden:{opacity:0,y:50},visible:{opacity:1,y:0,transition:{duration:.5}},exit:{opacity:0,y:-50,transition:{duration:.3}}},initial:"hidden",animate:"visible",exit:"exit",className:"relative rounded-2xl backdrop-blur-md bg-white/40 shadow-xl border border-white/30 p-4 mb-6",children:[(0,p.jsxs)("div",{className:"flex items-center gap-3 mb-3",children:[(0,p.jsx)("img",{src:t.user.profilePicture,alt:"Profile",className:"w-11 h-11 rounded-full object-cover ring-2 ring-white"}),(0,p.jsx)("h6",{className:"text-gray-900 font-semibold hover:underline cursor-pointer text-base",onClick:()=>{t.user._id===sessionStorage.getItem("userid")?j("/profile"):j(`/userprofile/${t.user._id}`,{state:{post:t}})},children:t.user.username})]}),t.image&&(0,p.jsx)(i.E.div,{className:"mb-4 rounded-xl overflow-hidden",children:(0,p.jsx)("img",{src:t.image,alt:"Post",className:"w-full object-cover rounded-xl shadow"})}),t.caption&&(0,p.jsxs)(i.E.p,{ref:v,className:"text-base font-medium text-gray-800 bg-gray-100 px-4 py-2 rounded-xl shadow-sm",initial:{opacity:0,y:-50},animate:{opacity:1,y:0,transition:{duration:.6}},children:[(0,p.jsx)("span",{className:"font-bold text-gray-900",children:"Caption: "}),t.caption]}),(0,p.jsxs)(i.E.p,{ref:v,className:"text-base font-medium text-gray-700 bg-gray-100 px-4 py-2 rounded-xl shadow-sm mt-2",initial:{opacity:0,x:-50},animate:{opacity:1,x:0,transition:{duration:.6}},children:[(0,p.jsx)("span",{className:"font-bold text-gray-900",children:"Mood: "}),"Normal"===t.mood?`${t.mood} ${w}`:"Sad"===t.mood?`${t.mood} ${E}`:"Happy"===t.mood?`${t.mood} ${N}`:"Unknown"]}),(0,p.jsxs)("div",{className:"flex items-center gap-6 mt-4",children:[(0,p.jsxs)(i.E.button,{onClick:async()=>{f(!y),k(y?b-1:b+1);try{const e=await(0,o.n9)(t._id),s=e.data.post.likes.some((e=>e.user===sessionStorage.getItem("userid")));f(s),k(e.data.post.likes.length)}catch(e){console.error("Error liking post:",e),f(!y),k(y?b+1:b-1)}},className:"flex items-center gap-2 text-gray-700 hover:text-red-500 transition",whileTap:{scale:.9},children:[y?(0,p.jsx)(r.Z,{className:"w-6 h-6 fill-red-500 text-red-500 transition"}):(0,p.jsx)(r.Z,{className:"w-6 h-6 transition"}),(0,p.jsx)("span",{className:"text-sm font-medium",children:b})]}),(0,p.jsxs)(i.E.button,{onClick:()=>(async e=>{try{const t=sessionStorage.getItem("token");if(!t)throw new Error("User not authenticated");await m.Z.post(`https://chatb-vrft.onrender.com
/api/auth/bookmark/${e}`,{},{headers:{Authorization:`${t}`}}),u.Am.success("Post bookmarked successfully!")}catch(t){console.error("Error bookmarking post:",t),u.Am.error("Failed to bookmark post. Please try again.")}})(t._id),className:"flex items-center gap-2 text-gray-700 hover:text-blue-500 transition",whileTap:{scale:.9},children:[(0,p.jsx)(l,{className:"w-6 h-6 transition"}),(0,p.jsx)("span",{className:"text-sm font-medium",children:"Save"})]}),(0,p.jsxs)(i.E.button,{onClick:()=>{var e;g(x===(e="comment")?"":e)},className:"flex items-center gap-2 text-gray-700 hover:text-green-500 transition",whileTap:{scale:.9},children:[(0,p.jsx)(c,{className:"w-6 h-6 transition"}),(0,p.jsx)("span",{className:"text-sm font-medium",children:"Comment"})]})]}),"comment"===x&&(0,p.jsxs)(i.E.form,{onSubmit:async e=>{e.preventDefault();try{await(0,o.L0)(t._id,{text:n}),h(""),u.Am.success("Comment posted successfully!")}catch(s){console.error("Error commenting on post:",s),u.Am.error("Failed to post comment. Please try again.")}},className:"flex items-center gap-2 mt-4",initial:{opacity:0},animate:{opacity:1,transition:{duration:.3}},children:[(0,p.jsx)("input",{type:"text",placeholder:"Add a comment...",value:n,onChange:e=>h(e.target.value),className:"flex-1 border rounded-full px-4 py-2 text-sm focus:outline-none focus:ring-2 focus:ring-blue-400"}),(0,p.jsx)("button",{type:"submit",className:"text-blue-600 font-medium",children:"Post"})]}),"menu"===x&&(0,p.jsxs)(i.E.div,{className:"mt-3 space-y-2",initial:{opacity:0,scale:.8},animate:{opacity:1,scale:1,transition:{duration:.3}},exit:{opacity:0,scale:.8,transition:{duration:.3}},children:[(0,p.jsx)("button",{className:"w-full text-left px-3 py-1.5 rounded-md text-blue-600 font-medium hover:bg-blue-100",onClick:()=>j(`create/${t._id}`,{state:{post:t}}),children:"Edit"}),(0,p.jsx)("button",{className:"w-full text-left px-3 py-1.5 rounded-md text-red-600 font-medium hover:bg-red-100",onClick:async()=>{try{await(0,o.v6)(t._id),s(t._id),u.Am.success("Post deleted successfully!")}catch(e){console.error("Error deleting post:",e),u.Am.error("Failed to delete post. Please try again.")}},children:"Delete"})]}),(0,p.jsx)(u.Ix,{position:"top-right",autoClose:2e3,hideProgressBar:!1,newestOnTop:!0,closeOnClick:!0,pauseOnHover:!0,draggable:!0,theme:"colored"})]})},x=()=>{const[e,t]=(0,a.useState)([]);console.log(e);const s=(0,d.s0)();(0,a.useEffect)((()=>{(async()=>{try{const{data:e}=await(0,o.T6)();t(e)}catch(e){401===e.status&&s("/login"),console.error(e)}})()}),[]),console.log(e),console.log(e);const i=s=>{t(e.filter((e=>e._id!==s)))};return console.log(e),(0,p.jsx)("div",{className:"flex flex-col gap-2 p-3",children:e.map((e=>(0,p.jsx)(h,{post:e,handleDeleteSuccess:i},e._id)))})}},409:(e,t,s)=>{s.d(t,{I8:()=>l,L0:()=>d,T6:()=>i,n9:()=>c,qb:()=>n,v6:()=>r});var a=s(903);s(612);const o=a.Z.create({baseURL:"https://chatb-vrft.onrender.com
/api"});o.interceptors.request.use((e=>(sessionStorage.getItem("token")&&(e.headers.Authorization=sessionStorage.getItem("token")),e)));const i=()=>o.get("/all"),r=e=>o.delete(`/delete/${e}`),n=e=>o.post("/addpost",e),l=(e,t)=>o.put(`/edit/${e}`,t),c=e=>o.post(`${e}/like`),d=(e,t)=>o.post(`${e}/comment`,t)},262:(e,t,s)=>{s.d(t,{Z:()=>a});const a=(0,s(100).Z)("heart",[["path",{d:"M19 14c1.49-1.46 3-3.21 3-5.5A5.5 5.5 0 0 0 16.5 3c-1.76 0-3 .5-4.5 2-1.5-1.5-2.74-2-4.5-2A5.5 5.5 0 0 0 2 8.5c0 2.3 1.5 4.05 3 5.5l7 7Z",key:"c3ymky"}]])},462:()=>{}}]);
//# sourceMappingURL=803.53cd4877.chunk.js.map