/*! For license information please see 851.07e8cbb7.chunk.js.LICENSE.txt */
"use strict";(self.webpackChunkclient=self.webpackChunkclient||[]).push([[851],{851:(e,t,s)=>{s.r(t),s.d(t,{default:()=>x});var r=s(791),a=s(689),n=s(87),i=s(903),c=s(100);const o=(0,c.Z)("arrow-left",[["path",{d:"m12 19-7-7 7-7",key:"1l729n"}],["path",{d:"M19 12H5",key:"x3x0zl"}]]),l=(0,c.Z)("ellipsis-vertical",[["circle",{cx:"12",cy:"12",r:"1",key:"41hilf"}],["circle",{cx:"12",cy:"5",r:"1",key:"gxeob9"}],["circle",{cx:"12",cy:"19",r:"1",key:"lyex9k"}]]),d=(0,c.Z)("send-horizontal",[["path",{d:"M3.714 3.048a.498.498 0 0 0-.683.627l2.843 7.627a2 2 0 0 1 0 1.396l-2.842 7.627a.498.498 0 0 0 .682.627l18-8.5a.5.5 0 0 0 0-.904z",key:"117uat"}],["path",{d:"M6 12h16",key:"s4cdu5"}]]);var g=s(264),u=s(770),h=s(184);const x=()=>{const{setMessages:e,messages:t,setSocket:s}=(0,g.Z)(),c=sessionStorage.getItem("userid"),{id:x}=(0,a.UO)(),m=(0,a.TH)(),[p,y]=(0,r.useState)(""),[f,v]=(0,r.useState)({}),[b,j]=(0,r.useState)(!1),[N,S]=(0,r.useState)(!1),w=(0,a.s0)();(0,r.useEffect)((()=>{const t=(0,u.h)();return t.connect(),s(t),t.emit("joinRoom",c),t.on("receiveMessage",(t=>{(t.sender===x&&t.receiver===c||t.sender===c&&t.receiver===x)&&e((e=>{const s=[...e,t];return localStorage.setItem("chatMessages",JSON.stringify(s)),s}))})),t.on("typing",(e=>{e===x&&S(!0)})),t.on("stopTyping",(e=>{e===x&&S(!1)})),()=>{t.off("receiveMessage"),t.off("typing"),t.off("stopTyping")}}),[c,x,e,s]),(0,r.useEffect)((()=>{(async()=>{try{const t=await i.Z.get(`https://chatb-vrft.onrender.com
/api/messages/${x}`,{headers:{Authorization:sessionStorage.getItem("token")}});e(t.data),localStorage.setItem("chatMessages",JSON.stringify(t.data))}catch(t){console.error("Error fetching chat messages:",t)}})()}),[c,x,e]);return(0,r.useEffect)((()=>{(async()=>{try{const e=await i.Z.get(`https://chatb-vrft.onrender.com
/api/auth/userpro/${x}`,{headers:{Authorization:sessionStorage.getItem("token")}});v(e.data)}catch(e){console.error("Error fetching user profile:",e)}})()}),[x]),(0,h.jsxs)("div",{className:"flex flex-col justify-between h-screen bg-white",children:[(0,h.jsxs)("div",{className:"flex items-center gap-3 px-4 py-3 border-b border-gray-200",children:[(0,h.jsx)("button",{onClick:()=>w(-1),className:"p-2 hover:bg-gray-100 rounded-full transition",children:(0,h.jsx)(o,{className:"h-5 w-5 text-gray-800"})}),(0,h.jsxs)(n.rU,{to:`/userprofile/${f._id}`,className:"flex items-center gap-3 flex-1",children:[(0,h.jsx)("img",{src:f.profilePicture,alt:"Profile",className:"w-9 h-9 rounded-full object-cover"}),(0,h.jsxs)("div",{className:"truncate",children:[(0,h.jsx)("h2",{className:"text-sm font-semibold text-gray-900 truncate",children:f.username}),N&&(0,h.jsx)("span",{className:"text-xs text-gray-500 italic animate-pulse",children:"Typing..."})]})]}),(0,h.jsx)("button",{className:"p-2 hover:bg-gray-100 rounded-full transition",children:(0,h.jsx)(l,{className:"h-5 w-5 text-gray-800"})})]}),(0,h.jsx)("div",{className:"flex-1 overflow-y-auto px-4 py-3 space-y-2 bg-gray-50",children:(m.state||t).map(((e,t)=>{var s,r;return(0,h.jsx)("div",{className:"flex "+(String((null===(s=e.sender)||void 0===s?void 0:s._id)||e.sender)===String(c)?"justify-end":"justify-start"),children:(0,h.jsxs)("div",{className:"px-4 py-2 rounded-2xl text-sm max-w-[75%] shadow "+(String((null===(r=e.sender)||void 0===r?void 0:r._id)||e.sender)===String(c)?"bg-blue-500 text-white rounded-br-none":"bg-gray-200 text-gray-800 rounded-bl-none"),children:[e.content,(0,h.jsx)("div",{className:"text-[10px] text-gray-500 mt-1 text-right",children:new Date(e.createdAt).toLocaleTimeString([],{hour:"2-digit",minute:"2-digit"})})]})},t)}))}),(0,h.jsxs)("div",{className:"border-t border-gray-200 bg-white px-3 py-2 flex items-center gap-2",children:[(0,h.jsx)("input",{type:"text",value:p,onChange:e=>{y(e.target.value);const t=(0,u.h)();e.target.value?t.emit("typing",c):(j(!1),t.emit("stopTyping",c))},onFocus:()=>j(!0),onBlur:()=>j(!1),placeholder:"Message...",className:"flex-1 px-4 py-2 rounded-full bg-gray-100 text-gray-800 placeholder:text-gray-500 focus:outline-none focus:ring-1 focus:ring-gray-400"}),(0,h.jsx)("button",{onClick:()=>{if(p.trim()){const t={sender:c,receiver:x,content:p,createdAt:(new Date).toISOString()},s=(0,u.h)();s.emit("sendMessage",t),e((e=>{const s=[...e,t];return localStorage.setItem("chatMessages",JSON.stringify(s)),s})),y(""),s.emit("stopTyping",c)}},className:"p-2 text-blue-500 hover:scale-110 transition-transform",children:(0,h.jsx)(d,{className:"h-6 w-6"})})]})]})}}}]);
//# sourceMappingURL=851.07e8cbb7.chunk.js.map